function count_haplotypes_in_experiment()

%Count haplotypes
%Sort haplotypes
%Check intersect
%Create new haplotypes
% There are 35 sequences because there are two Y9 strains

load('output/strains_in_study_20150622.mat')

load('output/strains_allele_swaps.mat')


get_orf_promoter=1;

%load('output/DNA_DATA_PROMOTER_ORF' queryGene);

load('output/DNA_DATA_ONLY_ORFS288C_YDR009W_GAL3_flanking.mat')

%load('output/DNA_DATA_PROMOTER_ORFS288C_YDR009W_GAL3_flanking.mat')

%% Sort the haplotypes based on size of strains

AllStrains_haplotypes={DNA_idx_identical_sequences.Strains};
AllStrains_haplotypes=AllStrains_haplotypes';
s=cellfun(@size,AllStrains_haplotypes,'uniform',false);
[trash is]=sortrows(cat(1,s{:}),-[1 2]);
AllStrains_haplotypes=AllStrains_haplotypes(is);
counter=1;

for iCell=1:length(AllStrains_haplotypes)
    
    %Check first cell and see intersection
    if ~(length(AllStrains_haplotypes{iCell})==1)
        
        QueryStrain_cell=intersect(AllStrains_haplotypes{iCell},strains_in_study_20150622);
        
        len_haplotype=length(QueryStrain_cell);
        
        if len_haplotype>1
            %intersect has to be longer than 1
            %QueryStrain_cell
            
            strains_haplotype_count(counter)=len_haplotype;
            counter=counter+1;

            
        end
    end
    
end

42-sum(strains_haplotype_count)

